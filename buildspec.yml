version: 0.2

phases:
  install:
    runtime-versions:
      docker: 18
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - docker login -u AWS -p eyJwYXlsb2FkIjoiS0tTRjNmNDBmSnpxZTRUNjlaQVQrYmw3b2hwV05MbWM5a2wvU1k2NkhkOVRISzJTdHFGMU1EMFRaRHpoc0FUeFh6a1lGZDZjTUxseWlwVXFqK1dFNTBqazlETjZKaThtei9aQUtPNnFTSzE2NXVDNms3UnFqVXhEd3RsN1lMZkhYT3lWUmpqcFduNE14dzNZRGc2Z0IyanlvNEZtYUtZNnkvcXFENnZjZnBaRkVPMC9vUnhkaGRpVVU0ZEVtSi94SVpPRXdDaTR5dmx4VmZFVUpYN09mR0lDVVd1aVExY3l2ZlBKTE1SZis3UExmQUQrV1I4bTEwdVA4dVVFKy9FRzNzQ0l0akRCdGJPeTUrVFRYWmNOK1BHMHFxSWhVNkljT1NQWWZ3RmZWdkF0TUdEUmJlMmRXc3lrRVpLMm1xeXUwSEt0Q0JFV2xsYzYrNUswRVZHV3VTZ25uWmcra1RTVDdUQ2pHOE5RM1ptTjFwRWpreUNhNkdBb0lwU2djZnBDL0lpVGIzaUNEWEtLSmxFN3dwNHpzNjlMOEUwZXZDMkY4NlM5dE1zOUVOV2ViWnlhRk1KUjRxNFhhUnQ4NHR0bU5yaUFqUHZLY29Uc1FqUDY5OElueWhoYzkvWVpHMHRSeHc3UHY3cXZjbEFNZVBVeVpCS0RzUGdUWFRFMlhRV0Jjb0NaTk1XUm83K0orT21tdUdhR1FSeDZ3WTg3NVRnZzBQK2crK0daNld5anNLQ053K2dKY2V0RnUxKzRHRzNpbE5DWFh5bWxJa0JkZU5YMjZtaTVIcXRBN0t1VUs5VmZLeXpKTC9RUGt4MnhoRzJxejlNc21qc1NNRXUzdzEzeW54MEc3YSttM2hTWlh6aHBwcXBVaWF1MVRwR3VnZ0FMYUN4bWgvU2hTK3hER2JldEhabysvelliMHJLRHlQSW1sYVI0VURrWXhVYlYrUGhqUFZDYXVMeWhFaFJ0eDVVdXordk9DRzdGNitHSmppRVJNOHlCeEZYT1V0Unh4QitCL1prL3Y0K3JsZm51ajNVNWNMQmdkdjhjQlI1QVlGdDFxd1NvelNnSm9XMTY1SWhhcG1rOUljSkhWdmNuU2UydzlZNzE5RTA4M1dBZVVoLzh6WjQzQWpELzBCTk5OQm1tWFhWY29XZksvNUpsMmQxWWJ2NWxiQ1JwRnFFbTMxT0pLTDFtbGlKL2orcDRlalBtVXMrN2JSb1N5NDZRc3RPNUxKUGcrWW1Tb0dWeWZYOTc1NkhrRDd1bG05emt0Q003SllRQk1HV1RnaFdCL0EwOHAydllGUHpwTTZIZ29Hb213bnYzamxYeWZWK2VPQ2hkc09hUTdNU01oMmR0RVlhd21FTzh4WGdycGdreE1yRWZhTGl3OGdpcVY3WW1KTk0wTnJvOHQxVU54ZGUzazdVUjNSUXo3dE9ZL05EWHBzLzJaZmNha1drUSIsImRhdGFrZXkiOiJBUUVCQUhod20wWWFJU0plUnRKbTVuMUc2dXFlZWtYdW9YWFBlNVVGY2U5UnE4LzE0d0FBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVESTRoZTZNTk9ZSWF5VDR0S1FJQkVJQTdobUIzNVpvdG1Ya0tQTEJRbHpFb3NPK0N0SkxjR0swek11QU4wbldYdzY5RFNrbkxSQ0s0cnVYaFQ5N0RkVzRJS1pqTnVibDFzUndhSDhBPSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTU2Njc1MTc4M30= https://223998089108.dkr.ecr.us-east-1.amazonaws.com
  build:
    commands:
      - echo Build started on `date`
      - echo Building the Docker image...          
      - docker build -t glcapstoneairpg .
      - docker tag glcapstoneairpg:latest 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest     
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker push 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest